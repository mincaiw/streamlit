# streamlit

# 代码实现功能说明

### 一、满足教授要求的部分

1. **地图展示与点击选择位置**

   - 使用 `folium` 结合 `streamlit_folium` 展示地图。
   - 用户可点击地图上的任意点，捕获点击的经纬度坐标。
   - 点击后自动调用 Kakao 逆地理编码 API，将经纬度转换为韩文地址，显示在页面上。

2. **民愿内容输入与日期选择**

   - 通过 `st.text_area` 输入民愿内容。
   - 使用 `st.date_input` 输入民愿日期，默认值为当天日期。

3. **提交人（作者）输入**

   - 通过 `st.text_input` 输入提交人姓名（可选）。

4. **民愿类型选择**

   - 通过下拉框（`st.selectbox`）选择民愿类型（교통、환경、치안、기타）。

5. **数据存储至 Google Sheets**

   - 提交数据（包含唯一 ID、内容、日期、坐标、作者、类型、地址）保存到 Google Sheets。
   - 读取 Google Sheets 数据，加载所有民愿。

6. **民愿数据展示**

   - 展示所有加载的民愿列表。
   - 支持按作者名检索过滤。
   - 列表项展示民愿详细信息（内容、日期、类型、地址等）。

7. **地图聚合显示民愿**

   - 地图上用不同颜色图标标记不同类型的民愿。
   - 使用 MarkerCluster 进行聚合显示，防止标记重叠。

8. **按类型与日期统计展示**

   - 使用柱状图显示不同类型民愿数量。
   - 使用柱状图显示不同日期的民愿提交数量。

9. **点赞功能**

   - 每条民愿显示“支持/赞同”按钮，支持计数显示。
   - 点击按钮时点赞计数增加，并保存至 Google Sheets。

---

### 二、额外增加的功能

- **民愿类型（카테고리）选择和显示**
- **地图 Marker 聚合与按类型颜色标记**
- **点赞数保存与更新到 Google Sheets**
- **点赞计数动态显示**

---

### 三、计划将要实现的功能

1. **限制每人每条民愿只能点赞一次**

   - 基于 `session_state` 或浏览器 Cookie 实现用户点赞唯一性。

2. **新增“民愿标题”字段**

   - 提交时填写标题。
   - 点赞排行榜页按标题排序显示。

3. **点赞排行榜页**

   - 显示所有民愿标题和对应点赞数。
   - 点击标题可查看民愿详情（内容、提交人等）。

4. **民愿内容和标题双重展示**

   - 提交民愿时增加标题输入框。
   - 展示列表和详情时同时展示标题和内容。

---

# 依赖库安装说明

请在终端中运行：

```bash
pip install streamlit pandas gspread oauth2client requests folium streamlit-folium
```

---

# Google Sheets 配置与权限说明

1. 创建 Google Cloud 项目，启用 Google Sheets API。

2. 创建服务账号，生成 JSON 密钥文件（命名为`token.json`）。

3. 在 Google Sheets 文档中，点击“共享”，输入服务账号的邮箱，赋予编辑权限。

4. 把`token.json`文件放置于代码同目录。

5. 运行程序时确保`token.json`路径正确，并有网络访问权限。
